<!-- Header screen -->
<div class="hidden md:block">
  <app-header></app-header>
</div>

<!-- Logo on mobile -->
<div class="flex justify-center my-6 md:hidden">
  <img src="/assets/logo.png" alt="MDD Logo" class="w-32 h-auto" />
</div>

<div class="flex flex-col items-center justify-center px-4 py-8">
  <!-- Titre -->
  <h1 class="text-2xl font-semibold mb-6">Se connecter</h1>

  <!-- Forms -->
  <form
    class="w-full max-w-xs mx-auto flex flex-col gap-3"
    [formGroup]="loginForm"
    (ngSubmit)="submit()"
    novalidate
  >
    @if (errorMessages(); as errors) {
      <div
        class="rounded-md border border-red-200 bg-red-50 p-4"
        role="alert"
        aria-live="assertive"
      >
        <div class="flex">
          <div class="flex-shrink-0">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 20 20"
              fill="currentColor"
              class="h-5 w-5 text-red-400"
              aria-hidden="true"
            >
              <path
                fill-rule="evenodd"
                d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 001.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z"
                clip-rule="evenodd"
              />
            </svg>
          </div>
          <div class="ml-3">
            <h3 class="text-sm font-medium text-red-800">Connexion impossible</h3>
            <div class="mt-2 text-sm text-red-700">
              <ul class="list-disc space-y-1 pl-5">
                <li *ngFor="let error of errors">{{ error }}</li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    }

    <div>
      <label for="identifier" class="block text-sm mb-1"
        >E-mail ou nom d'utilisateur <span class="text-red-500">*</span></label
      >
      <input
        id="identifier"
        type="text"
        formControlName="identifier"
        autocomplete="username"
        class="w-full h-9 border rounded-lg px-2.5 focus:outline-none focus:ring-2 transition-colors"
        [ngClass]="
          identifierInvalid
            ? ['border-red-500', 'focus:border-red-500', 'focus:ring-red-300']
            : [
                'border-gray-400',
                'focus:border-[#7763C5]',
                'focus:ring-[#7763C5]/40'
              ]
        "
        [attr.aria-invalid]="identifierInvalid"
      />
    </div>

    <div>
      <label for="password" class="block text-sm mb-1"
        >Mot de passe <span class="text-red-500">*</span></label
      >
      <div class="relative">
        <input
          id="password"
          [type]="showPassword ? 'text' : 'password'"
          formControlName="password"
          autocomplete="current-password"
          class="w-full h-9 border rounded-lg px-2.5 pr-9 focus:outline-none focus:ring-2 transition-colors"
          [ngClass]="
            passwordInvalid
              ? ['border-red-500', 'focus:border-red-500', 'focus:ring-red-300']
              : [
                  'border-gray-400',
                  'focus:border-[#7763C5]',
                  'focus:ring-[#7763C5]/40'
                ]
          "
          [attr.aria-invalid]="passwordInvalid"
        />
        <button
          type="button"
          class="absolute inset-y-0 right-2 flex items-center text-gray-500"
          (click)="togglePasswordVisibility()"
          aria-label="Afficher ou masquer le mot de passe"
        >
          <svg
            *ngIf="!showPassword"
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="1.5"
            class="w-5 h-5"
            aria-hidden="true"
          >
            <path
              d="M1.5 12s3.75-6.75 10.5-6.75S22.5 12 22.5 12s-3.75 6.75-10.5 6.75S1.5 12 1.5 12z"
            />
            <circle cx="12" cy="12" r="3.75" />
          </svg>
          <svg
            *ngIf="showPassword"
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="1.5"
            class="w-5 h-5"
            aria-hidden="true"
          >
            <path
              d="M3.98 8.223C5.726 6.042 8.669 4.5 12 4.5c6.75 0 10.5 7.5 10.5 7.5a19.5 19.5 0 0 1-2.288 3.338"
            />
            <path d="M6.223 6.223 17.778 17.78" />
            <path
              d="M9.75 9.863A3.75 3.75 0 0 1 12 8.25a3.75 3.75 0 0 1 3.75 3.75c0 .823-.264 1.587-.713 2.206"
            />
            <path
              d="M6.47 6.47C3.36 8.674 1.5 12 1.5 12a19.425 19.425 0 0 0 4.196 4.827C7.385 18.507 9.61 19.5 12 19.5c1.233 0 2.383-.24 3.444-.663"
            />
          </svg>
        </button>
      </div>
      <p
        class="text-xs mt-1"
        [ngClass]="passwordInvalid ? 'text-red-500' : 'text-gray-500'"
      >
        Le mot de passe doit comporter au moins 6 caract√®res.
      </p>
    </div>

    <!-- Submit form -->
    <button
      type="submit"
      class="w-full mt-4 h-10 bg-[#7763C5] text-white font-bold rounded-lg hover:bg-[#7763C5] transition-colors px-6 self-center disabled:cursor-not-allowed disabled:opacity-60"
      [disabled]="isSubmitting()"
    >
      Se connecter
    </button>
  </form>
</div>
