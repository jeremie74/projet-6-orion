<app-header></app-header>

<main class="px-6 py-10">
  <div class="mx-auto flex w-full max-w-5xl flex-col gap-8">
    <div class="flex items-center justify-between">
      <section class="flex flex-col gap-2 text-left">
        <h1 class="text-2xl font-semibold text-gray-900">Articles du thème</h1>
        @if (topicLabel()) {
        <h2 class="text-2xl text-[#7763C5] font-bold">{{ topicLabel() }}</h2>
        }
      </section>
      <a
        routerLink="/posts/topics"
        class="inline-flex h-10 items-center justify-center rounded-lg border border-gray-300 px-4 text-sm font-medium text-gray-700 hover:bg-gray-100"
        >Tous les thèmes</a
      >
    </div>

    @if (isLoading()) {
    <div
      class="rounded-lg border border-gray-200 bg-white px-4 py-6 text-sm text-gray-700"
    >
      Chargement des articles...
    </div>
    } @else if (hasError()) {
    <div
      class="rounded-lg border border-red-200 bg-red-50 px-4 py-6 text-sm text-red-700"
    >
      {{ errorMessage() ?? "Une erreur inattendue est survenue." }}
    </div>
    } @else if (posts().length === 0) {
    <div
      class="rounded-lg border border-dashed border-gray-300 bg-gray-50 px-6 py-10 text-center text-sm text-gray-500"
    >
      Aucun article pour ce thème.
    </div>
    } @else {
    <div class="grid gap-6 sm:grid-cols-2">
      @for (post of posts(); track post.id) {
      <article
        class="flex h-full flex-col gap-4 rounded-xl border border-gray-200 bg-white p-6 shadow-sm"
      >
        <h3 class="text-lg font-semibold text-gray-900">
          <a
            [routerLink]="['/posts/topics', post.topicId, 'posts', post.id]"
            class="hover:underline focus:underline"
          >
            {{ post.title }}
          </a>
        </h3>
        <div class="flex items-center gap-3 text-sm text-gray-500">
          <span>{{ post.createdAt | date : "dd/MM/yyyy" }}</span>
          <span class="h-1 w-1 rounded-full bg-gray-300"></span>
          <span>{{ post.authorUsername }}</span>
        </div>
        <p class="text-sm text-gray-600">{{ post.content }}</p>
      </article>
      }
    </div>
    }
  </div>
</main>
